<section id="enorganico-matcha" class="enorganico enorganico-matcha py-[5rem]!">
  <div class="container d-none d-md-block">
    <div class="row">
      <div class="col-12">
        <div class="card-header text-center">
          <h2 class="uppercase text-lg! text-(--enorganico-primary-color)!">Nuestro</h2>
          <h1 class="text-7xl! uppercase font-black! text-(--enorganico-secondary-color)! opacity-50">Matcha <br /> Ecologico</h1>
          <p class="uppercase text-(--enorganico-primary-color)">Más que una bebida: un ritual consciente.</p>
        </div>
      </div>
      <div class="col-12 min-h-[60vh]">
        <div class="card-slider relative h-100">
          <div class="nav h-100 w-100 absolute top-0 left-0 right-0 bottom-0">
            <div class="prev absolute top-0 left-0 w-[100px] h-[100px] bg-(--enorganico-primary-color) flex justify-center items-center cursor-pointer">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6 scale-200">
                <path fill-rule="evenodd" d="M7.72 12.53a.75.75 0 0 1 0-1.06l7.5-7.5a.75.75 0 1 1 1.06 1.06L9.31 12l6.97 6.97a.75.75 0 1 1-1.06 1.06l-7.5-7.5Z" clip-rule="evenodd"></path>
              </svg>
            </div>
            <div class="next absolute bottom-0 right-0 w-[100px] h-[100px] bg-(--enorganico-primary-color) flex justify-center items-center cursor-pointer">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6 scale-200">
                <path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path>
              </svg>
            </div>
          </div>

          <div class="items relative w-100 h-10">
            <div class="item flex justify-center items-center absolute mt-[5rem]!">
              <h1 class="title w-[calc(100%/3)] text-end uppercase text-6xl! text-shadow-[1px 1px 0px white] text-(--enorganico-primary-color)!">Matcha<br />Latte<br />Classic</h1>
              <div class="matcha-card w-[calc(100%/3)]">
                <img src="/web/image/1637-9b8d4b05/imagen-34.webp" alt="Matcha Latte Classic" class="img img-fluid card-bg m-auto w-50" />
              </div>
              <div class="content w-[calc(100%/3)]">
                <p><strong>Cremoso, suave y perfectamente equilibrado.</strong></p>
                <p>Nuestro matcha en su forma más pura. Cremoso, suave y balanceado, con notas vegetales limpias y un final reconfortante. Ideal para quienes buscan energía estable y sabor auténtico, sin artificios.</p>
              </div>
            </div>
            <div class="item flex justify-center items-center absolute mt-[5rem]!">
              <h1 class="title w-[calc(100%/3)] text-end uppercase text-6xl! text-shadow-[1px 1px 0px white] text-(--enorganico-primary-color)!">Vanilla<br />Matcha<br />Latte</h1>
              <div class="matcha-card w-[calc(100%/3)]">
                <img src="/web/image/1639-c20218c8/imagen-35.webp" alt="Vanilla Matcha Latte" class="img img-fluid card-bg m-auto w-50" />
              </div>
              <div class="content w-[calc(100%/3)]">
                <p><strong>Dulce y aromático con notas de vainilla.</strong></p>
                <p>La suavidad del matcha se encuentra con el dulzor delicado de la vainilla, creando una bebida cálida y envolvente. Perfecta para quienes prefieren un perfil más amable, sin perder la esencia natural del té.</p>
              </div>
            </div>
            <div class="item flex justify-center items-center absolute mt-[5rem]!">
              <h1 class="title w-[calc(100%/3)] text-end uppercase text-6xl! text-shadow-[1px 1px 0px white] text-(--enorganico-primary-color)!">Pistaccio<br />Matcha<br />Latte</h1>
              <div class="matcha-card w-[calc(100%/3)]">
                <img src="/web/image/1641-0fc0ee98/imagen-36.webp" alt="Pistaccio Matcha Latte" class="img img-fluid card-bg m-auto w-50" />
              </div>
              <div class="content w-[calc(100%/3)]">
                <p><strong>Fusión original y perfecta de matcha con crema de pistacho.</strong></p>
                <p>Una combinación cremosa y ligeramente tostada donde el carácter vegetal del matcha se equilibra con la suavidad del pistacho. Un latte distinto, elegante y lleno de matices.</p>
              </div>
            </div>
            <div class="item flex justify-center items-center absolute mt-[5rem]!">
              <h1 class="title w-[calc(100%/3)] text-end uppercase text-6xl! text-shadow-[1px 1px 0px white] text-(--enorganico-primary-color)!">Cinnamon<br />Matcha<br />Latte</h1>
              <div class="matcha-card w-[calc(100%/3)]">
                <img src="/web/image/1638-68575722/imagen-37.webp" alt="Cinnamon Matcha Latte" class="img img-fluid card-bg m-auto w-50" />
              </div>
              <div class="content w-[calc(100%/3)]">
                <p><strong>Exótico, ligero y carácter tropical.</strong></p>
                <p>Una versión fresca y suave donde el matcha se mezcla con notas tropicales que aportan ligereza y un final delicadamente dulce. Ideal para quienes buscan algo diferente y refrescante.</p>
              </div>
            </div>
            <div class="item flex justify-center items-center absolute mt-[5rem]!">
              <h1 class="title w-[calc(100%/3)] text-end uppercase text-6xl! text-shadow-[1px 1px 0px white] text-(--enorganico-primary-color)!">Coconut<br />Matcha<br />Latte</h1>
              <div class="matcha-card w-[calc(100%/3)]">
                <img src="/web/image/1640-8f816775/imagen-38.webp" alt="Coconut Matcha Latte" class="img img-fluid card-bg m-auto w-50" />
              </div>
              <div class="content w-[calc(100%/3)]">
                <p><strong>Suave, tropical y naturalmente reconfortante.</strong></p>
                <p>El matcha se combina con la cremosidad del coco para crear una bebida ligera, aromática y sutilmente dulce. Una opción equilibrada que evoca calma y frescura en cada sorbo.</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="container d-block d-md-none">
    <div class="row">
      <div class="col-12">
        <div class="card-header text-center">
          <h2 class="uppercase text-lg! text-(--enorganico-primary-color)!">Nuestro</h2>
          <h1 class="text-7xl! uppercase font-black! text-(--enorganico-primary-color)!">Matcha <br /> Ecologico</h1>
          <p class="uppercase text-(--enorganico-primary-color)">Más que una bebida: un ritual consciente.</p>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="items-mobile relative w-100 h-10">
        <div class="item-mobile flex justify-center items-center mt-[5rem]!">
          <div class="matcha-card w-[calc(100%/2)]">
            <img src="/web/image/1637-9b8d4b05/imagen-34.webp" alt="Matcha Latte Classic" class="img img-fluid card-bg m-auto w-75" />
          </div>
          <div class="content w-[calc(100%/2)] pl-3">
            <h1 class="title text-start uppercase text-lg! text-shadow-[1px 1px 0px white] text-(--enorganico-primary-color)!">Matcha Latte Classic</h1>
            <p><strong>Cremoso, suave y perfectamente equilibrado.</strong></p>
            <p>Nuestro matcha en su forma más pura. Cremoso, suave y balanceado, con notas vegetales limpias y un final reconfortante. Ideal para quienes buscan energía estable y sabor auténtico, sin artificios.</p>
          </div>
        </div>
        <div class="item-mobile flex justify-center items-center mt-[5rem]!">
          <div class="matcha-card w-[calc(100%/2)]">
            <img src="/web/image/1639-c20218c8/imagen-35.webp" alt="Vanilla Matcha Latte" class="img img-fluid card-bg m-auto w-75" />
          </div>
          <div class="content w-[calc(100%/2)] pl-3">
            <h1 class="title text-start uppercase text-lg! text-shadow-[1px 1px 0px white] text-(--enorganico-primary-color)!">Vanilla Matcha Latte</h1>
            <p><strong>Dulce y aromático con notas de vainilla.</strong></p>
            <p>La suavidad del matcha se encuentra con el dulzor delicado de la vainilla, creando una bebida cálida y envolvente. Perfecta para quienes prefieren un perfil más amable, sin perder la esencia natural del té.</p>
          </div>
        </div>
        <div class="item-mobile flex justify-center items-center mt-[5rem]!">
          <div class="matcha-card w-[calc(100%/2)]">
            <img src="/web/image/1641-0fc0ee98/imagen-36.webp" alt="Pistaccio Matcha Latte" class="img img-fluid card-bg m-auto w-75" />
          </div>
          <div class="content w-[calc(100%/2)] pl-3">
            <h1 class="title text-start uppercase text-lg! text-shadow-[1px 1px 0px white] text-(--enorganico-primary-color)!">Pistaccio Matcha Latte</h1>
            <p><strong>Fusión original y perfecta de matcha con crema de pistacho.</strong></p>
            <p>Una combinación cremosa y ligeramente tostada donde el carácter vegetal del matcha se equilibra con la suavidad del pistacho. Un latte distinto, elegante y lleno de matices.</p>
          </div>
        </div>
        <div class="item-mobile flex justify-center items-center mt-[5rem]!">
          <div class="matcha-card w-[calc(100%/2)]">
            <img src="/web/image/1638-68575722/imagen-37.webp" alt="Cinnamon Matcha Latte" class="img img-fluid card-bg m-auto w-75" />
          </div>
          <div class="content w-[calc(100%/2)] pl-3">
            <h1 class="title text-start uppercase text-lg! text-shadow-[1px 1px 0px white] text-(--enorganico-primary-color)!">Cinnamon Matcha Latte</h1>
            <p><strong>Exótico, ligero y carácter tropical.</strong></p>
            <p>Una versión fresca y suave donde el matcha se mezcla con notas tropicales que aportan ligereza y un final delicadamente dulce. Ideal para quienes buscan algo diferente y refrescante.</p>
          </div>
        </div>
        <div class="item-mobile flex justify-center items-center mt-[5rem]!">
          <div class="matcha-card w-[calc(100%/2)]">
            <img src="/web/image/1640-8f816775/imagen-38.webp" alt="Coconut Matcha Latte" class="img img-fluid card-bg m-auto w-75" />
          </div>
          <div class="content w-[calc(100%/2)] pl-3">
            <h1 class="title text-start uppercase text-lg! text-shadow-[1px 1px 0px white] text-(--enorganico-primary-color)!">Coconut Matcha Latte</h1>
            <p><strong>Suave, tropical y naturalmente reconfortante.</strong></p>
            <p>El matcha se combina con la cremosidad del coco para crear una bebida ligera, aromática y sutilmente dulce. Una opción equilibrada que evoca calma y frescura en cada sorbo.</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<script is:inline>
  document.addEventListener("DOMContentLoaded", function () {
    const slider = document.querySelector(".card-slider");
    const items = document.querySelectorAll(".card-slider .item");
    const prevBtn = document.querySelector(".card-slider .prev");
    const nextBtn = document.querySelector(".card-slider .next");
    const navButtons = document.querySelectorAll(".card-slider .nav div");

    let currentIndex = 0;
    let isAnimating = false;
    const totalItems = items.length;

    // Inicializar: mostrar solo el primer item
    items.forEach((item, index) => {
      if (index === 0) {
        gsap.set(item, {
          display: "flex",
          opacity: 1,
          x: 0,
        });
        item.classList.add("is-active");
      } else {
        gsap.set(item, {
          display: "flex",
          opacity: 0,
          x: 100,
        });
      }
    });

    // Función para cambiar slide con animación
    function goToSlide(index, direction = "next") {
      if (isAnimating || index === currentIndex) return;

      isAnimating = true;
      const oldIndex = currentIndex;
      currentIndex = index;

      // Determinar dirección de la animación
      const fromX = direction === "next" ? 100 : -100;
      const toX = direction === "next" ? -100 : 100;

      // Crear timeline para animaciones sincronizadas
      const tl = gsap.timeline({
        defaults: { duration: 0.8, ease: "power2.inOut" },
        onComplete: () => {
          isAnimating = false;

          // Remover clase is-active de todos
          items.forEach((item) => item.classList.remove("is-active"));
          // Agregar clase is-active al slide actual
          items[currentIndex].classList.add("is-active");
        },
      });

      // Animar salida del slide actual
      tl.to(
        items[oldIndex],
        {
          x: toX,
          opacity: 0,
          onComplete: () => {
            gsap.set(items[oldIndex], { x: 0 });
          },
        },
        0
      );

      // Animar entrada del nuevo slide
      tl.fromTo(items[currentIndex], { x: fromX, opacity: 0 }, { x: 0, opacity: 1 }, 0.2);

      // Añadir efecto parallax sutil a los elementos internos
      const title = items[currentIndex].querySelector(".title");
      const image = items[currentIndex].querySelector(".matcha-card img");
      const content = items[currentIndex].querySelector(".content");

      if (title && image && content) {
        tl.from(
          title,
          {
            x: fromX * 1.5,
            opacity: 0,
            duration: 0.6,
          },
          0.3
        );

        tl.from(
          image,
          {
            scale: 0.8,
            opacity: 0,
            duration: 0.7,
            ease: "back.out(1.2)",
          },
          0.4
        );

        tl.from(
          content,
          {
            x: fromX * 1.5,
            opacity: 0,
            duration: 0.6,
          },
          0.5
        );
      }
    }

    // Función para ir al siguiente slide
    function nextSlide() {
      const nextIndex = (currentIndex + 1) % totalItems;
      goToSlide(nextIndex, "next");
    }

    // Función para ir al slide anterior
    function prevSlide() {
      const prevIndex = (currentIndex - 1 + totalItems) % totalItems;
      goToSlide(prevIndex, "prev");
    }

    // Event listeners para botones de navegación
    prevBtn.addEventListener("click", prevSlide);
    nextBtn.addEventListener("click", nextSlide);

    // Navegación por teclado
    document.addEventListener("keydown", function (e) {
      if (e.key === "ArrowLeft") {
        prevSlide();
      } else if (e.key === "ArrowRight") {
        nextSlide();
      }
    });

    // Auto-play opcional (descomentar si lo quieres)
    let autoPlayInterval;
    function startAutoPlay() {
      autoPlayInterval = setInterval(nextSlide, 5000);
    }

    function stopAutoPlay() {
      clearInterval(autoPlayInterval);
    }

    // Iniciar auto-play
    startAutoPlay();

    // Pausar auto-play al interactuar
    slider.addEventListener("mouseenter", stopAutoPlay);
    slider.addEventListener("mouseleave", startAutoPlay);
    navButtons.forEach((btn) => {
      btn.addEventListener("mouseenter", stopAutoPlay);
    });

    // Efecto hover en botones de navegación
    navButtons.forEach((btn) => {
      btn.addEventListener("mouseenter", function () {
        gsap.to(this, {
          scale: 1.1,
          duration: 0.3,
          ease: "power2.out",
        });

        // Efecto de brillo en el icono
        const svg = this.querySelector("svg");
        if (svg) {
          gsap.to(svg, {
            scale: 2.2,
            duration: 0.3,
            ease: "power2.out",
          });
        }
      });

      btn.addEventListener("mouseleave", function () {
        gsap.to(this, {
          scale: 1,
          duration: 0.3,
          ease: "power2.out",
        });

        const svg = this.querySelector("svg");
        if (svg) {
          gsap.to(svg, {
            scale: 2,
            duration: 0.3,
            ease: "power2.out",
          });
        }
      });
    });

    // Inicializar ScrollTrigger para efectos de entrada
    if (typeof ScrollTrigger !== "undefined") {
      // Efecto de entrada para toda la sección
      gsap.from("#enorganico-matcha .card-header", {
        scrollTrigger: {
          trigger: "#enorganico-matcha",
          start: "top 80%",
          end: "bottom 20%",
          toggleActions: "play none none reverse",
        },
        y: 50,
        opacity: 0,
        duration: 1,
        ease: "power2.out",
      });

      // Efecto de entrada para el slider
      gsap.from(".card-slider", {
        scrollTrigger: {
          trigger: ".card-slider",
          start: "top 75%",
          end: "bottom 25%",
          toggleActions: "play none none reverse",
        },
        y: 30,
        opacity: 0,
        duration: 1.2,
        delay: 0.3,
        ease: "power2.out",
      });
    }

    // Función para pre-cargar imágenes (mejora rendimiento)
    function preloadImages() {
      items.forEach((item) => {
        const img = item.querySelector("img");
        if (img && img.src) {
          const image = new Image();
          image.src = img.src;
        }
      });
    }

    // Pre-cargar imágenes
    preloadImages();
  });
</script>
